"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[951],{5951:function(e,r,t){t.d(r,{Z:function(){return E}});var a=t(7437),s=t(2265),n=t(5671),i=t(575),l=t(2782),c=t(3277);class o{static getInstance(){return o.instance||(o.instance=new o),o.instance}async query(e,r){try{let e=new URLSearchParams;r.search&&e.append("q",r.search),r.page&&e.append("page",r.page.toString()),r.perPage&&e.append("perPage",r.perPage.toString());let a=await fetch("".concat(this.baseUrl,"?").concat(e.toString()),{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}});if(!a.ok)throw Error("HTTP error! status: ".concat(a.status));let s=await a.json();if(s.errors){var t;throw Error((null===(t=s.errors[0])||void 0===t?void 0:t.message)||"AniList API error")}return s}catch(e){throw console.error("AniList API error:",e),e}}async searchAnime(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return(await this.query("\n      query ($search: String, $page: Int, $perPage: Int) {\n        Page(page: $page, perPage: $perPage) {\n          media(search: $search, type: ANIME, sort: [POPULARITY_DESC, SCORE_DESC]) {\n            id\n            title {\n              romaji\n              english\n              native\n            }\n            type\n            format\n            episodes\n            duration\n            status\n            season\n            seasonYear\n            description\n            genres\n            averageScore\n            coverImage {\n              large\n              medium\n            }\n            bannerImage\n            startDate {\n              year\n              month\n              day\n            }\n            endDate {\n              year\n              month\n              day\n            }\n            synonyms\n            countryOfOrigin\n          }\n        }\n      }\n    ",{search:e,page:r,perPage:t})).data.Page.media}async getAnimeById(e){return(await this.query("\n      query ($id: Int) {\n        Media(id: $id, type: ANIME) {\n          id\n          title {\n            romaji\n            english\n            native\n          }\n          type\n          format\n          episodes\n          duration\n          status\n          season\n          seasonYear\n          description\n          genres\n          averageScore\n          coverImage {\n            large\n            medium\n          }\n          bannerImage\n          startDate {\n            year\n            month\n            day\n          }\n          endDate {\n            year\n            month\n            day\n          }\n          synonyms\n          countryOfOrigin\n        }\n      }\n    ",{id:e})).data.Media}convertStatus(e){switch(e){case"FINISHED":return"已完結";case"RELEASING":case"NOT_YET_RELEASED":default:return"進行中";case"CANCELLED":return"放棄";case"HIATUS":return"暫停"}}convertFormat(e){switch(e){case"TV":return"電視動畫";case"TV_SHORT":return"電視動畫短篇";case"MOVIE":return"電影";case"SPECIAL":return"特別篇";case"OVA":return"OVA";case"ONA":return"網路動畫";case"MUSIC":return"音樂動畫";case"MANGA":return"漫畫";case"NOVEL":return"小說";case"ONE_SHOT":return"單篇";default:return e}}convertSeason(e){if(!e)return"";switch(e){case"WINTER":return"冬季";case"SPRING":return"春季";case"SUMMER":return"夏季";case"FALL":return"秋季";default:return e}}convertType(e){switch(e){case"ANIME":return"動畫";case"MANGA":return"漫畫";default:return e}}convertTypeToWorkType(e){switch(e){case"ANIME":default:return"動畫";case"MANGA":return"漫畫"}}convertRating(e){if(e)return Math.round(e/20)}cleanDescription(e){if(e)return e.replace(/<[^>]*>/g,"").trim()}getYear(e){return e.year||void 0}convertToTraditional(e){return e.replace(/进/g,"進").replace(/击/g,"擊").replace(/灭/g,"滅").replace(/贼/g,"賊").replace(/龙/g,"龍").replace(/记/g,"記").replace(/学院/g,"學院").replace(/术/g,"術").replace(/回/g,"迴").replace(/战/g,"戰").replace(/谍/g,"諜").replace(/锯/g,"鋸").replace(/种/g,"種").replace(/命运/g,"命運").replace(/门/g,"門").replace(/鲁/g,"魯").replace(/世纪/g,"世紀").replace(/战士/g,"戰士").replace(/壳/g,"殼").replace(/机动/g,"機動").replace(/队/g,"隊").replace(/隐/g,"隱").replace(/猫/g,"貓").replace(/霍尔/g,"霍爾").replace(/移动/g,"移動").replace(/猪/g,"豬").replace(/辉/g,"輝").replace(/耀/g,"耀").replace(/回忆/g,"回憶").replace(/玛/g,"瑪").replace(/妮/g,"妮").replace(/缇/g,"緹").replace(/来自/g,"來自").replace(/红花/g,"紅花").replace(/报恩/g,"報恩").replace(/儿时/g,"兒時").replace(/点点滴滴/g,"點點滴滴").replace(/萤火虫/g,"螢火蟲").replace(/合战/g,"合戰").replace(/邻居/g,"鄰居").replace(/战记/g,"戰記").replace(/龟/g,"龜").replace(/魔女/g,"魔女").replace(/怎样/g,"怎樣")}getBestChineseTitle(e,r){if(r){let e=r.find(e=>/[\u4e00-\u9fff]/.test(e)&&e.length>0);if(e)return this.convertToTraditional(e)}return e.romaji||e.english||e.native}getAllTitles(e,r){let t=[],a=this.getBestChineseTitle(e,r);return a&&!t.includes(a)&&t.push(a),r&&r.forEach(e=>{/[\u4e00-\u9fff]/.test(e)&&e.length>0&&!t.includes(e)&&t.push(e)}),e.romaji&&!t.includes(e.romaji)&&t.push(e.romaji),e.english&&e.english!==e.romaji&&!t.includes(e.english)&&t.push(e.english),e.native&&e.native!==e.romaji&&!t.includes(e.native)&&t.push(e.native),t}constructor(){this.baseUrl="/api/search"}}let d=o.getInstance();var g=t(3536),m=t(1827),u=t(2549),h=t(6264),x=t(4900),p=t(8203),f=t(2245),y=t(9883),v=t(8956),j=t(6141),w=t(2505),N=t(6637);function b(e){var r,t;let{anime:l,isOpen:o,onClose:m,onSelectAnime:h}=e,[b,E]=(0,s.useState)(!1),[S,A]=(0,s.useState)(null),{createWork:I}=(0,g.B)();if(!o||!l)return null;let T=async()=>{E(!0),A(null);try{let e={title:d.getBestChineseTitle(l.title,l.synonyms),type:d.convertTypeToWorkType(l.type),status:d.convertStatus(l.status),year:d.getYear(l.startDate),rating:d.convertRating(l.averageScore),review:d.cleanDescription(l.description),note:"來自 AniList (ID: ".concat(l.id,")\n格式: ").concat(d.convertFormat(l.format),"\n").concat(l.season&&l.seasonYear?"播出時間: ".concat(d.convertSeason(l.season)," ").concat(l.seasonYear,"年"):"","\n其他標題: ").concat(d.getAllTitles(l.title,l.synonyms).slice(1).join(", ")),source:"AniList",episodes:l.episodes?Array.from({length:l.episodes},(e,r)=>({id:"ep-".concat(l.id,"-").concat(r+1),number:r+1,type:"episode",season:1,watched:!1})):[]},r=await I(e);m(),console.log("成功新增作品:",r.title)}catch(e){console.error("新增作品失敗:",e),A(e instanceof Error?e.message:"新增作品時發生錯誤，請稍後再試。")}finally{E(!1)}},C=e=>{if(!e.year)return"未知";let r=[e.year];return null!==e.month&&r.push(e.month.toString().padStart(2,"0")),null!==e.day&&r.push(e.day.toString().padStart(2,"0")),r.join("-")};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)(n.Zb,{className:"w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[(0,a.jsx)(n.Ol,{className:"border-b",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(n.ll,{className:"flex items-center",children:[(0,a.jsx)(v.Z,{className:"w-5 h-5 mr-2"}),"動畫詳情"]}),(0,a.jsx)(i.z,{variant:"ghost",size:"sm",onClick:m,children:(0,a.jsx)(u.Z,{className:"w-4 h-4"})})]})}),(0,a.jsx)(n.aY,{className:"overflow-y-auto max-h-[70vh] p-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsx)("div",{className:"lg:col-span-1",children:(null===(r=l.coverImage)||void 0===r?void 0:r.large)&&(0,a.jsxs)("div",{className:"sticky top-0",children:[(0,a.jsx)("img",{src:l.coverImage.large,alt:l.title.romaji,className:"w-full rounded-lg shadow-lg"}),l.bannerImage&&(0,a.jsx)("img",{src:l.bannerImage,alt:"Banner",className:"w-full h-32 object-cover rounded-lg mt-4"})]})}),(0,a.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-2",children:d.getBestChineseTitle(l.title,l.synonyms)}),l.title.romaji&&(0,a.jsx)("p",{className:"text-lg description-text mb-1",children:l.title.romaji}),l.title.english&&l.title.english!==l.title.romaji&&(0,a.jsx)("p",{className:"text-lg description-text mb-1",children:l.title.english}),l.title.native&&(0,a.jsx)("p",{className:"text-lg description-text",children:l.title.native})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsx)(c.C,{className:(e=>{switch(e){case"FINISHED":return"bg-green-100 text-green-800";case"RELEASING":return"bg-blue-100 text-blue-800";case"NOT_YET_RELEASED":return"bg-yellow-100 text-yellow-800";case"CANCELLED":case"HIATUS":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(l.status),children:(e=>{switch(e){case"FINISHED":return"已完結";case"RELEASING":return"連載中";case"NOT_YET_RELEASED":return"未播出";case"CANCELLED":return"已取消";case"HIATUS":return"暫停";default:return e}})(l.status)}),l.format&&(0,a.jsx)(c.C,{variant:"outline",children:(t=l.format,d.convertFormat(t))}),l.episodes&&(0,a.jsxs)(c.C,{variant:"outline",children:[(0,a.jsx)(x.Z,{className:"w-3 h-3 mr-1"}),l.episodes," 集"]}),l.duration&&(0,a.jsxs)(c.C,{variant:"outline",children:[(0,a.jsx)(j.Z,{className:"w-3 h-3 mr-1"}),l.duration," 分鐘"]}),l.season&&l.seasonYear&&(0,a.jsxs)(c.C,{variant:"outline",children:[(0,a.jsx)(p.Z,{className:"w-3 h-3 mr-1"}),((e,r)=>{if(!e||!r)return"";let t=d.convertSeason(e);return"".concat(r,"年").concat(t)})(l.season,l.seasonYear)]})]}),l.averageScore&&(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(f.Z,{className:"w-5 h-5 star-icon mr-2"}),(0,a.jsxs)("span",{className:"text-lg font-semibold",children:[(l.averageScore/10).toFixed(1),"/10"]}),(0,a.jsxs)("span",{className:"text-sm note-text ml-2",children:["(",l.averageScore," 分)"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"font-semibold mb-2 flex items-center",children:[(0,a.jsx)(p.Z,{className:"w-4 h-4 mr-1"}),"播出時間"]}),(0,a.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"description-text",children:"開始："}),C(l.startDate)]}),l.endDate&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"description-text",children:"結束："}),C(l.endDate)]})]})]}),l.genres&&l.genres.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"font-semibold mb-2 flex items-center",children:[(0,a.jsx)(w.Z,{className:"w-4 h-4 mr-1"}),"類型"]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:l.genres.map(e=>(0,a.jsx)(c.C,{variant:"secondary",className:"text-xs",children:e},e))})]})]}),l.description&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"font-semibold mb-2 flex items-center",children:[(0,a.jsx)(N.Z,{className:"w-4 h-4 mr-1"}),"簡介"]}),(0,a.jsx)("div",{className:"text-sm text-gray-700 dark:text-gray-300 leading-relaxed",dangerouslySetInnerHTML:{__html:l.description.replace(/\n/g,"<br>")}})]}),l.synonyms&&l.synonyms.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold mb-2",children:"其他標題"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-1",children:[l.synonyms.slice(0,10).map((e,r)=>(0,a.jsx)(c.C,{variant:"outline",className:"text-xs",children:e},r)),l.synonyms.length>10&&(0,a.jsxs)(c.C,{variant:"outline",className:"text-xs",children:["+",l.synonyms.length-10," 更多"]})]})]}),l.countryOfOrigin&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold mb-2",children:"來源國家"}),(0,a.jsx)(c.C,{variant:"outline",children:l.countryOfOrigin})]})]})]})}),(0,a.jsxs)("div",{className:"border-t p-4 bg-gray-50 dark:bg-gray-800",children:[S&&(0,a.jsx)("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900/20 border border-red-400 dark:border-red-800 text-red-700 dark:text-red-200 rounded",children:S}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[(0,a.jsxs)("p",{children:["將新增作品："," ",(0,a.jsx)("span",{className:"font-medium",children:d.getBestChineseTitle(l.title,l.synonyms)})]}),l.episodes&&(0,a.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["自動創建 ",l.episodes," 集"]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(i.z,{variant:"outline",onClick:m,children:"取消"}),(0,a.jsx)(i.z,{onClick:T,disabled:b,children:b?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-4 h-4 mr-2 border-2 border-white border-t-transparent rounded-full animate-spin"}),"新增中..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(y.Z,{className:"w-4 h-4 mr-2"}),"新增作品"]})})]})]})]})]})})}function E(e){let{onSelectAnime:r,onClose:t,isOpen:o}=e,[v,j]=(0,s.useState)(""),[w,N]=(0,s.useState)([]),[E,S]=(0,s.useState)(!1),[A,I]=(0,s.useState)(null),[T,C]=(0,s.useState)(null),[L,k]=(0,s.useState)(!1),[D,O]=(0,s.useState)(null),{createWork:Y}=(0,g.B)(),R=function(e,r){let[t,a]=(0,s.useState)(e);return(0,s.useEffect)(()=>{let t=setTimeout(()=>{a(e)},r);return()=>{clearTimeout(t)}},[e,r]),t}(v,500),Z=(0,s.useCallback)(async e=>{if(!e.trim()){N([]);return}S(!0),I(null);try{let r=await d.searchAnime(e,1,10);N(r)}catch(e){I(e instanceof Error?e.message:"搜尋失敗"),N([])}finally{S(!1)}},[]);(0,s.useEffect)(()=>{R?Z(R):N([])},[R,Z]);let _=e=>{C(e)},P=e=>{O(e),k(!0)},B=e=>{switch(e){case"FINISHED":return"bg-green-100 text-green-800";case"RELEASING":return"bg-blue-100 text-blue-800";case"NOT_YET_RELEASED":return"bg-yellow-100 text-yellow-800";case"CANCELLED":case"HIATUS":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},F=e=>{switch(e){case"FINISHED":return"已完結";case"RELEASING":return"連載中";case"NOT_YET_RELEASED":return"未播出";case"CANCELLED":return"已取消";case"HIATUS":return"暫停";default:return e}},M=e=>d.convertFormat(e),H=(e,r)=>{if(!e||!r)return"";let t=d.convertSeason(e);return"".concat(r,"年").concat(t)};return o?(0,a.jsxs)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:[(0,a.jsxs)(n.Zb,{className:"w-full max-w-4xl mx-4 max-h-[90vh] overflow-hidden",children:[(0,a.jsxs)(n.Ol,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(n.ll,{className:"flex items-center",children:[(0,a.jsx)(m.Z,{className:"w-5 h-5 mr-2"}),"從 AniList 搜尋動畫"]}),(0,a.jsx)(i.z,{variant:"ghost",size:"sm",onClick:t,children:(0,a.jsx)(u.Z,{className:"w-4 h-4"})})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(l.I,{value:v,onChange:e=>j(e.target.value),placeholder:"搜尋動畫名稱...",className:"pr-10"}),E&&(0,a.jsx)(h.Z,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 animate-spin"})]})]}),(0,a.jsxs)(n.aY,{className:"overflow-y-auto max-h-[60vh]",children:[A&&(0,a.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:A}),0===w.length&&!E&&v&&(0,a.jsx)("div",{className:"text-center py-8 empty-state",children:"沒有找到相關動畫"}),!v&&(0,a.jsx)("div",{className:"text-center py-8 empty-state",children:"輸入動畫名稱開始搜尋"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:w.map(e=>{var r;return(0,a.jsx)(n.Zb,{className:"cursor-pointer transition-all hover:shadow-md ".concat((null==T?void 0:T.id)===e.id?"ring-2 ring-blue-500 selected-bg":""),onClick:()=>P(e),children:(0,a.jsxs)(n.aY,{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex space-x-4",children:[(null===(r=e.coverImage)||void 0===r?void 0:r.medium)&&(0,a.jsx)("img",{src:e.coverImage.medium,alt:e.title.romaji,className:"w-16 h-24 object-cover rounded"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h3",{className:"font-semibold text-lg truncate",children:d.getBestChineseTitle(e.title,e.synonyms)}),e.title.romaji&&(0,a.jsx)("p",{className:"text-sm description-text truncate",children:e.title.romaji}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 mt-2",children:[(0,a.jsx)(c.C,{className:B(e.status),children:F(e.status)}),e.format&&(0,a.jsx)(c.C,{variant:"outline",className:"text-xs",children:M(e.format)}),e.episodes&&(0,a.jsxs)(c.C,{variant:"outline",className:"text-xs",children:[(0,a.jsx)(x.Z,{className:"w-3 h-3 mr-1"}),e.episodes," 集"]}),e.season&&e.seasonYear&&(0,a.jsxs)(c.C,{variant:"outline",className:"text-xs",children:[(0,a.jsx)(p.Z,{className:"w-3 h-3 mr-1"}),H(e.season,e.seasonYear)]})]}),e.averageScore&&(0,a.jsxs)("div",{className:"flex items-center mt-2",children:[(0,a.jsx)(f.Z,{className:"w-4 h-4 star-icon mr-1"}),(0,a.jsxs)("span",{className:"text-sm description-text",children:[(e.averageScore/10).toFixed(1),"/10"]})]}),e.genres&&e.genres.length>0&&(0,a.jsx)("div",{className:"flex flex-wrap gap-1 mt-2",children:e.genres.slice(0,3).map(e=>(0,a.jsx)(c.C,{variant:"secondary",className:"text-xs",children:e},e))})]})]}),(0,a.jsx)("div",{className:"flex gap-2 mt-3",children:(0,a.jsx)(i.z,{size:"sm",variant:"outline",onClick:r=>{r.stopPropagation(),_(e)},className:"flex-1",children:"選擇"})})]})},e.id)})})]}),T&&(0,a.jsx)("div",{className:"border-t p-4 bg-gray-50 dark:bg-gray-800",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["已選擇:"," ",(0,a.jsx)("span",{className:"font-medium",children:d.getBestChineseTitle(T.title,T.synonyms)})]}),T.episodes&&(0,a.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["將自動創建 ",T.episodes," 集"]})]}),(0,a.jsxs)(i.z,{onClick:()=>{if(!T)return;let e={title:d.getBestChineseTitle(T.title,T.synonyms),type:d.convertTypeToWorkType(T.type),status:d.convertStatus(T.status),year:d.getYear(T.startDate),rating:d.convertRating(T.averageScore),review:d.cleanDescription(T.description),note:"來自 AniList (ID: ".concat(T.id,")\n格式: ").concat(d.convertFormat(T.format),"\n").concat(T.season&&T.seasonYear?"播出時間: ".concat(d.convertSeason(T.season)," ").concat(T.seasonYear,"年"):"","\n其他標題: ").concat(d.getAllTitles(T.title,T.synonyms).slice(1).join(", ")),source:"AniList",episodes:T.episodes?Array.from({length:T.episodes},(e,r)=>({id:"ep-".concat(T.id,"-").concat(r+1),number:r+1,type:"episode",season:1,watched:!1})):[]};try{Y(e),t()}catch(r){let e=r instanceof Error?r.message:"新增作品失敗";alert(e)}},children:[(0,a.jsx)(y.Z,{className:"w-4 h-4 mr-2"}),"新增作品"]})]})})]}),(0,a.jsx)(b,{anime:D,isOpen:L,onClose:()=>{k(!1),O(null)},onSelectAnime:r})]}):null}},3277:function(e,r,t){t.d(r,{C:function(){return l}});var a=t(7437);t(2265);var s=t(6061),n=t(2169);let i=(0,s.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary/90 text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary/90 text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive/90 text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground border-border/60"}},defaultVariants:{variant:"default"}});function l(e){let{className:r,variant:t,...s}=e;return(0,a.jsx)("div",{className:(0,n.cn)(i({variant:t}),r),...s})}},2782:function(e,r,t){t.d(r,{I:function(){return i}});var a=t(7437),s=t(2265),n=t(2169);let i=s.forwardRef((e,r)=>{let{className:t,type:s,...i}=e;return(0,a.jsx)("input",{type:s,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input/60 bg-background/95 px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground/70 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring/50 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...i})});i.displayName="Input"},3536:function(e,r,t){t.d(r,{B:function(){return n}});var a=t(4660),s=t(5809);let n=(0,a.Ue)((e,r)=>({works:[],tags:[],stats:null,loading:!1,error:null,initialize:async()=>{try{await s.we.init(),await s.IL.init();let r=await s.we.getAll();0===r.length&&await (0,s.W0)();let t=await s.we.getAll(),a=await s.IL.getAll(),n=await s.we.getStats();e({works:t,tags:a,stats:n})}catch(r){console.error("初始化失敗:",r),e({error:"初始化失敗"})}},fetchWorks:async r=>{e({loading:!0,error:null});try{let t=await s.we.getList(r);return e({works:t.works,loading:!1}),t}catch(r){throw e({error:r instanceof Error?r.message:"取得作品列表失敗",loading:!1}),r}},createWork:async r=>{e({loading:!0,error:null});try{if(await s.we.findByTitle(r.title))throw Error("作品「".concat(r.title,"」已存在於您的收藏中！"));if("AniList"===r.source&&r.note){let e=r.note.match(/AniList ID: (\d+)/);if(e){let t=parseInt(e[1]);if(await s.we.findByAniListId(t))throw Error("作品「".concat(r.title,"」已存在於您的收藏中！"))}}let t=await s.we.create(r),a=await s.we.getAll(),n=await s.we.getStats();return e({works:a,stats:n,loading:!1}),t}catch(r){throw e({error:r instanceof Error?r.message:"新增作品失敗",loading:!1}),r}},updateWork:async(r,t)=>{e({loading:!0,error:null});try{let a=await s.we.update(r,t);if(!a)throw Error("作品不存在");let n=await s.we.getAll(),i=await s.we.getStats();return e({works:n,stats:i,loading:!1}),a}catch(r){throw e({error:r instanceof Error?r.message:"更新作品失敗",loading:!1}),r}},deleteWork:async r=>{e({loading:!0,error:null});try{if(!await s.we.delete(r))throw Error("作品不存在");let t=await s.we.getAll(),a=await s.we.getStats();return e({works:t,stats:a,loading:!1}),!0}catch(r){throw e({error:r instanceof Error?r.message:"刪除作品失敗",loading:!1}),r}},getWork:async e=>{try{return(await s.we.getAll()).find(r=>r.id===e)||null}catch(e){return console.error("取得作品失敗:",e),null}},updateWorks:async r=>{try{await s.we.setAll(r),e({works:r})}catch(e){console.error("更新作品失敗:",e)}},fetchTags:async()=>{e({loading:!0,error:null});try{let r=await s.IL.getAll();return e({tags:r,loading:!1}),r}catch(r){throw e({error:r instanceof Error?r.message:"取得標籤列表失敗",loading:!1}),r}},createTag:async r=>{e({loading:!0,error:null});try{let t=await s.IL.create(r),a=await s.IL.getAll();return e({tags:a,loading:!1}),t}catch(r){throw e({error:r instanceof Error?r.message:"新增標籤失敗",loading:!1}),r}},updateTag:async(r,t)=>{e({loading:!0,error:null});try{let a=await s.IL.update(r,t);if(!a)throw Error("標籤不存在");let n=await s.IL.getAll();return e({tags:n,loading:!1}),a}catch(r){throw e({error:r instanceof Error?r.message:"更新標籤失敗",loading:!1}),r}},deleteTag:async r=>{e({loading:!0,error:null});try{if(!await s.IL.delete(r))throw Error("標籤不存在");let t=await s.IL.getAll();return e({tags:t,loading:!1}),!0}catch(r){throw e({error:r instanceof Error?r.message:"刪除標籤失敗",loading:!1}),r}},updateTags:async r=>{try{await s.IL.setAll(r),e({tags:r})}catch(e){console.error("更新標籤失敗:",e)}},fetchStats:async()=>{e({loading:!0,error:null});try{let r=await s.we.getStats();return e({stats:r,loading:!1}),r}catch(r){throw e({error:r instanceof Error?r.message:"取得統計數據失敗",loading:!1}),r}}}))}}]);