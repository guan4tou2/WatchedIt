(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[90],{3725:function(e,t,r){Promise.resolve().then(r.bind(r,6113))},6113:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return c},dynamic:function(){return o}});var s=r(7437),n=r(2265),i=r(5671),a=r(575),l=r(841),d=r(170);let o="force-dynamic";function c(){let[e,t]=(0,n.useState)([]),[r,o]=(0,n.useState)(!1),c=(r,s)=>{try{let n=l.we.create({title:"測試".concat(r," - ").concat(new Date().toLocaleTimeString()),type:r,status:"進行中",year:2024,rating:4,episodes:s,source:"測試新增"});t([...e,n])}catch(e){console.error("新增測試作品失敗:",e)}};return((0,n.useEffect)(()=>{o(!0)},[]),r)?(0,s.jsxs)("div",{className:"container mx-auto p-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"集數管理測試"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)(i.Zb,{children:[(0,s.jsx)(i.Ol,{children:(0,s.jsx)(i.ll,{children:"測試操作"})}),(0,s.jsxs)(i.aY,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)(a.z,{onClick:()=>{c("動畫",[{id:"ep-1",number:1,title:"第一集",description:"這是第一集的描述",type:"episode",season:1,watched:!0,date_watched:new Date().toISOString()},{id:"ep-2",number:2,title:"第二集",description:"這是第二集的描述",type:"episode",season:1,watched:!1},{id:"ep-special",number:1,title:"特別篇",description:"這是特別篇的描述",type:"special",season:1,watched:!1}])},children:"新增動畫測試"}),(0,s.jsx)(a.z,{onClick:()=>{c("小說",[{id:"ch-1",number:1,title:"第一章",description:"這是第一章的內容",type:"chapter",season:1,watched:!0,date_watched:new Date().toISOString()},{id:"ch-2",number:2,title:"第二章",description:"這是第二章的內容",type:"chapter",season:1,watched:!1}])},children:"新增小說測試"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(a.z,{onClick:()=>{try{let e=l.we.getAll().filter(e=>!e.title.includes("測試"));localStorage.setItem("watchedit_works",JSON.stringify(e)),t([])}catch(e){console.error("清除測試作品失敗:",e)}},variant:"outline",className:"w-full",children:"清除測試作品"}),(0,s.jsx)(a.z,{onClick:()=>{console.log("所有作品:",l.we.getAll())},variant:"outline",className:"w-full",children:"查看所有作品"})]})]})]}),(0,s.jsxs)(i.Zb,{children:[(0,s.jsx)(i.Ol,{children:(0,s.jsx)(i.ll,{children:"集數管理組件測試"})}),(0,s.jsx)(i.aY,{children:(0,s.jsx)(d.Z,{episodes:[{id:"test-1",number:1,title:"測試集數",description:"這是一個測試集數",type:"episode",season:1,watched:!1}],onEpisodesChange:e=>{console.log("集數更新:",e)},type:"動畫"})})]})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)(i.Zb,{children:[(0,s.jsx)(i.Ol,{children:(0,s.jsx)(i.ll,{children:"測試作品列表"})}),(0,s.jsx)(i.aY,{children:(0,s.jsxs)("div",{className:"space-y-2",children:[e.map((e,t)=>{let r=e.episodes||[],n=r.filter(e=>e.watched).length,i=r.length;return(0,s.jsxs)("div",{className:"border p-3 rounded",children:[(0,s.jsx)("div",{className:"font-medium",children:e.title}),(0,s.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["類型: ",e.type," | 集數: ",n,"/",i," ","(",i>0?Math.round(n/i*100):0,"%)"]}),(0,s.jsxs)("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:["集數類型:"," ",Object.entries(r.reduce((e,t)=>(e[t.type]=(e[t.type]||0)+1,e),{})).map(e=>{let[t,r]=e;return"".concat(t,":").concat(r)}).join(", ")]})]},t)}),0===e.length&&(0,s.jsx)("div",{className:"text-gray-500 dark:text-gray-400 text-center py-4",children:"還沒有測試作品"})]})})]}),(0,s.jsxs)(i.Zb,{children:[(0,s.jsx)(i.Ol,{children:(0,s.jsx)(i.ll,{children:"統計數據"})}),(0,s.jsx)(i.aY,{children:(0,s.jsx)("pre",{className:"text-sm bg-gray-100 p-3 rounded overflow-auto",children:JSON.stringify(l.we.getStats(),null,2)})})]})]})]})]}):(0,s.jsxs)("div",{className:"container mx-auto p-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"集數管理測試"}),(0,s.jsx)("p",{children:"載入中..."})]})}},575:function(e,t,r){"use strict";r.d(t,{z:function(){return o}});var s=r(7437),n=r(2265),i=r(7256),a=r(6061),l=r(2169);let d=(0,a.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary/90 text-primary-foreground hover:bg-primary/80",destructive:"bg-destructive/90 text-destructive-foreground hover:bg-destructive/80",outline:"border border-input/60 bg-background hover:bg-accent/50 hover:text-accent-foreground",secondary:"bg-secondary/90 text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent/50 hover:text-accent-foreground",link:"text-primary/90 underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=n.forwardRef((e,t)=>{let{className:r,variant:n,size:a,asChild:o=!1,...c}=e,u=o?i.g7:"button";return(0,s.jsx)(u,{className:(0,l.cn)(d({variant:n,size:a,className:r})),ref:t,...c})});o.displayName="Button"},5671:function(e,t,r){"use strict";r.d(t,{Ol:function(){return l},Zb:function(){return a},aY:function(){return o},ll:function(){return d}});var s=r(7437),n=r(2265),i=r(2169);let a=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("rounded-lg border border-border/60 bg-card/95 text-card-foreground shadow-sm",r),...n})});a.displayName="Card";let l=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",r),...n})});l.displayName="CardHeader";let d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("h3",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight text-foreground/95 dark:text-foreground/98",r),...n})});d.displayName="CardTitle",n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("p",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground/80 dark:text-muted-foreground/90",r),...n})}).displayName="CardDescription";let o=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",r),...n})});o.displayName="CardContent",n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",r),...n})}).displayName="CardFooter"},841:function(e,t,r){"use strict";r.d(t,{IL:function(){return a},W0:function(){return l},we:function(){return i}});let s={WORKS:"watchedit_works",TAGS:"watchedit_tags"};function n(){return new Date().toISOString()}let i={getAll(){try{let e=localStorage.getItem(s.WORKS);return e?JSON.parse(e):[]}catch(e){return console.error("讀取作品數據失敗:",e),[]}},setAll(e){try{localStorage.setItem(s.WORKS,JSON.stringify(e))}catch(e){console.error("儲存作品數據失敗:",e)}},findByTitle(e){return this.getAll().find(t=>t.title===e)||null},findByAniListId(e){return this.getAll().find(t=>t.note&&t.note.includes("AniList ID: ".concat(e)))||null},create(e){var t;let r=this.getAll(),i={id:"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}),...e,reminder_enabled:null!==(t=e.reminder_enabled)&&void 0!==t&&t,date_added:n(),date_updated:void 0,tags:[],episodes:e.episodes||[]};return r.push(i),localStorage.setItem(s.WORKS,JSON.stringify(r)),i},update(e,t){let r=this.getAll(),i=r.findIndex(t=>t.id===e);return -1===i?null:(r[i]={...r[i],...t,date_updated:n()},localStorage.setItem(s.WORKS,JSON.stringify(r)),r[i])},delete(e){let t=this.getAll(),r=t.filter(t=>t.id!==e);return r.length!==t.length&&(localStorage.setItem(s.WORKS,JSON.stringify(r)),!0)},getList(e){let t=this.getAll();(null==e?void 0:e.title)&&(t=t.filter(t=>t.title.toLowerCase().includes(e.title.toLowerCase()))),(null==e?void 0:e.type)&&(t=t.filter(t=>t.type===e.type)),(null==e?void 0:e.status)&&(t=t.filter(t=>t.status===e.status)),(null==e?void 0:e.year)&&(t=t.filter(t=>t.year===e.year)),(null==e?void 0:e.tag_ids)&&e.tag_ids.length>0&&(t=t.filter(t=>t.tags.some(t=>e.tag_ids.includes(t.id))));let r=(null==e?void 0:e.page)||1,s=(null==e?void 0:e.size)||20,n=(r-1)*s;return{works:t.slice(n,n+s),total:t.length,page:r,size:s}},getStats(){let e=this.getAll(),t={};e.forEach(e=>{t[e.type]=(t[e.type]||0)+1});let r={};e.forEach(e=>{r[e.status]=(r[e.status]||0)+1});let s={};e.forEach(e=>{var t;let r=(null===(t=e.year)||void 0===t?void 0:t.toString())||"未知";s[r]=(s[r]||0)+1});let n=0,i=0;e.forEach(e=>{e.episodes&&(n+=e.episodes.length,i+=e.episodes.filter(e=>e.watched).length)});let a=n>0?Math.round(i/n*100):0;return{total_works:e.length,type_stats:t,status_stats:r,year_stats:s,episode_stats:{total_episodes:n,watched_episodes:i,completion_rate:a}}}},a={getAll(){try{let e=localStorage.getItem(s.TAGS);return e?JSON.parse(e):[]}catch(e){return console.error("讀取標籤數據失敗:",e),[]}},setAll(e){try{localStorage.setItem(s.TAGS,JSON.stringify(e))}catch(e){console.error("儲存標籤數據失敗:",e)}},create(e){let t=this.getAll(),r={id:Math.max(0,...t.map(e=>e.id))+1,...e};return t.push(r),localStorage.setItem(s.TAGS,JSON.stringify(t)),r},update(e,t){let r=this.getAll(),n=r.findIndex(t=>t.id===e);return -1===n?null:(r[n]={...r[n],...t},localStorage.setItem(s.TAGS,JSON.stringify(r)),r[n])},delete(e){let t=this.getAll(),r=t.filter(t=>t.id!==e);return r.length!==t.length&&(localStorage.setItem(s.TAGS,JSON.stringify(r)),!0)}},l=()=>{let e=i.getAll(),t=a.getAll();0===e.length&&(i.create({title:"進擊的巨人",type:"動畫",status:"已完結",year:2013,rating:5,review:"經典神作！",source:"AniList",episodes:[{id:"ep-1",number:1,title:"致2000年後的你",description:"艾連\xb7葉卡在夢中看到未來",type:"episode",season:1,watched:!0,date_watched:"2023-01-15T00:00:00.000Z"},{id:"ep-2",number:2,title:"那一天",description:"巨人入侵希干希納區",type:"episode",season:1,watched:!0,date_watched:"2023-01-15T00:00:00.000Z"},{id:"ep-special",number:1,title:"無悔的選擇",description:"里維兵長的外傳",type:"special",season:1,watched:!1}]}),i.create({title:"鬼滅之刃",type:"動畫",status:"進行中",year:2019,rating:4,source:"AniList",episodes:[{id:"ep-1",number:1,title:"殘酷",description:"竈門炭治郎的家人被鬼襲擊",type:"episode",season:1,watched:!0,date_watched:"2023-02-01T00:00:00.000Z"},{id:"ep-2",number:2,title:"培育者 鱗瀧左近次",description:"炭治郎開始學習呼吸法",type:"episode",season:1,watched:!0,date_watched:"2023-02-01T00:00:00.000Z"},{id:"ep-3",number:3,title:"鬼舞辻無慘",description:"炭治郎遇到鬼舞辻無慘",type:"episode",season:1,watched:!1}]}),i.create({title:"哈利波特與魔法石",type:"小說",status:"已完結",year:1997,rating:5,review:"魔法世界的開始",source:"手動新增",episodes:[{id:"ch-1",number:1,title:"活下來的男孩",description:"哈利波特被送到德思禮家",type:"chapter",season:1,watched:!0,date_watched:"2023-03-01T00:00:00.000Z"},{id:"ch-2",number:2,title:"消失的玻璃",description:"哈利發現自己的魔法能力",type:"chapter",season:1,watched:!0,date_watched:"2023-03-01T00:00:00.000Z"}]})),0===t.length&&(a.create({name:"神作",color:"#FF6B6B"}),a.create({name:"熱血",color:"#4ECDC4"}),a.create({name:"劇情",color:"#45B7D1"}),a.create({name:"魔法",color:"#96CEB4"}),a.create({name:"冒險",color:"#FFEAA7"}))}},2169:function(e,t,r){"use strict";r.d(t,{a:function(){return a},cn:function(){return i}});var s=r(7042),n=r(4769);function i(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.m6)((0,s.W)(t))}function a(e){return"".concat("/WatchedIt").concat(e)}}},function(e){e.O(0,[621,170,971,458,744],function(){return e(e.s=3725)}),_N_E=e.O()}]);