(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[141],{5310:function(e,s,a){Promise.resolve().then(a.bind(a,8583))},8583:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return i}});var l=a(7437),t=a(2265),c=a(575),n=a(5671),r=a(5809);function i(){let[e,s]=(0,t.useState)([]),[a,i]=(0,t.useState)([]),[d,o]=(0,t.useState)(null),[x,h]=(0,t.useState)(!1),[j,m]=(0,t.useState)("");(0,t.useEffect)(()=>{u()},[]);let u=async()=>{h(!0);try{let[e,a,l]=await Promise.all([r.we.getAll(),r.IL.getAll(),r.qC.getDatabaseInfo()]);s(e),i(a),o(l)}catch(e){console.error("載入數據失敗:",e),m("載入數據失敗")}finally{h(!1)}},p=async()=>{h(!0);try{let e={title:"測試作品 ".concat(Date.now()),type:"動畫",status:"進行中",year:2024,rating:4,source:"測試",episodes:[{id:"ep-".concat(Date.now()),number:1,title:"測試集數",description:"這是一個測試集數",type:"episode",season:1,watched:!0,date_watched:new Date().toISOString()}]};await r.we.create(e),await u(),m("新增作品成功")}catch(e){console.error("新增作品失敗:",e),m("新增作品失敗")}finally{h(!1)}},y=async()=>{h(!0);try{await r.IL.create({name:"測試標籤 ".concat(Date.now()),color:"#FF6B6B"}),await u(),m("新增標籤成功")}catch(e){console.error("新增標籤失敗:",e),m("新增標籤失敗")}finally{h(!1)}},b=async()=>{if(confirm("確定要清空所有數據嗎？")){h(!0);try{await r.qC.clearAll(),await u(),m("清空數據成功")}catch(e){console.error("清空數據失敗:",e),m("清空數據失敗")}finally{h(!1)}}},f=async()=>{h(!0);try{let e=await r.qC.exportData(),s=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),a=URL.createObjectURL(s),l=document.createElement("a");l.href=a,l.download="indexeddb_test_".concat(Date.now(),".json"),document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a),m("匯出數據成功")}catch(e){console.error("匯出數據失敗:",e),m("匯出數據失敗")}finally{h(!1)}};return(0,l.jsxs)("div",{className:"container mx-auto p-6",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"IndexedDB 測試"}),j&&(0,l.jsx)("div",{className:"mb-4 p-4 bg-blue-100 dark:bg-blue-900/20 text-blue-800 dark:text-blue-200 rounded-md",children:j}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,l.jsxs)(n.Zb,{children:[(0,l.jsx)(n.Ol,{children:(0,l.jsx)(n.ll,{children:"資料庫信息"})}),(0,l.jsx)(n.aY,{children:d?(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("p",{children:["作品數量: ",d.worksCount]}),(0,l.jsxs)("p",{children:["標籤數量: ",d.tagsCount]})]}):(0,l.jsx)("p",{children:"載入中..."})})]}),(0,l.jsxs)(n.Zb,{children:[(0,l.jsx)(n.Ol,{children:(0,l.jsx)(n.ll,{children:"操作"})}),(0,l.jsxs)(n.aY,{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex space-x-2",children:[(0,l.jsx)(c.z,{onClick:p,disabled:x,children:x?"處理中...":"新增作品"}),(0,l.jsx)(c.z,{onClick:y,disabled:x,children:x?"處理中...":"新增標籤"})]}),(0,l.jsxs)("div",{className:"flex space-x-2",children:[(0,l.jsx)(c.z,{onClick:u,disabled:x,children:x?"載入中...":"重新載入"}),(0,l.jsx)(c.z,{onClick:f,disabled:x,children:x?"處理中...":"匯出數據"})]}),(0,l.jsx)(c.z,{onClick:b,disabled:x,variant:"destructive",children:x?"處理中...":"清空所有數據"})]})]}),(0,l.jsxs)(n.Zb,{children:[(0,l.jsx)(n.Ol,{children:(0,l.jsxs)(n.ll,{children:["作品列表 (",e.length,")"]})}),(0,l.jsx)(n.aY,{children:(0,l.jsxs)("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:[e.map(e=>(0,l.jsxs)("div",{className:"p-2 border rounded",children:[(0,l.jsx)("p",{className:"font-medium",children:e.title}),(0,l.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e.type," • ",e.status," • ",e.year]})]},e.id)),0===e.length&&(0,l.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"沒有作品"})]})})]}),(0,l.jsxs)(n.Zb,{children:[(0,l.jsx)(n.Ol,{children:(0,l.jsxs)(n.ll,{children:["標籤列表 (",a.length,")"]})}),(0,l.jsx)(n.aY,{children:(0,l.jsxs)("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:[a.map(e=>(0,l.jsxs)("div",{className:"p-2 border rounded",children:[(0,l.jsx)("p",{className:"font-medium",children:e.name}),(0,l.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["顏色: ",e.color]})]},e.id)),0===a.length&&(0,l.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"沒有標籤"})]})})]})]})]})}}},function(e){e.O(0,[621,330,971,458,744],function(){return e(e.s=5310)}),_N_E=e.O()}]);