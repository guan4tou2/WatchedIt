<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>åœ–ç¤ºæ¸¬è©¦ - WatchedIt</title>
    <link rel="icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="/icons/icon-192x192.png" />
    <link rel="manifest" href="/manifest.json" />
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        background: #f5f5f5;
      }
      .icon-test {
        background: white;
        padding: 20px;
        margin: 20px 0;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      .icon-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
        gap: 20px;
        margin: 20px 0;
      }
      .icon-item {
        text-align: center;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
        background: white;
      }
      .icon-item img {
        max-width: 100%;
        height: auto;
      }
      .status {
        padding: 10px;
        border-radius: 4px;
        margin: 10px 0;
      }
      .success {
        background: #d4edda;
        color: #155724;
      }
      .error {
        background: #f8d7da;
        color: #721c24;
      }
    </style>
  </head>
  <body>
    <h1>ğŸ¯ WatchedIt åœ–ç¤ºæ¸¬è©¦</h1>

    <div class="icon-test">
      <h2>ğŸ“‹ æ¸¬è©¦é …ç›®</h2>
      <div id="test-results"></div>
    </div>

    <div class="icon-test">
      <h2>ğŸ–¼ï¸ åœ–ç¤ºé è¦½</h2>
      <div class="icon-grid" id="icon-grid"></div>
    </div>

    <div class="icon-test">
      <h2>ğŸ“± PWA æ¸¬è©¦</h2>
      <p>æª¢æŸ¥ç€è¦½å™¨é–‹ç™¼è€…å·¥å…·ä¸­çš„ Application æ¨™ç±¤é ï¼ŒæŸ¥çœ‹ï¼š</p>
      <ul>
        <li>Manifest æ˜¯å¦æ­£ç¢ºè¼‰å…¥</li>
        <li>åœ–ç¤ºæ˜¯å¦é¡¯ç¤ºæ­£ç¢º</li>
        <li>Service Worker æ˜¯å¦è¨»å†ŠæˆåŠŸ</li>
      </ul>
    </div>

    <script>
      const sizes = [72, 96, 128, 144, 152, 192, 384, 512];
      const testResults = document.getElementById("test-results");
      const iconGrid = document.getElementById("icon-grid");

      let passedTests = 0;
      let totalTests = 0;

      function addTestResult(name, passed, message) {
        totalTests++;
        if (passed) passedTests++;

        const div = document.createElement("div");
        div.className = `status ${passed ? "success" : "error"}`;
        div.innerHTML = `${passed ? "âœ…" : "âŒ"} ${name}: ${message}`;
        testResults.appendChild(div);
      }

      // æ¸¬è©¦åœ–ç¤ºæª”æ¡ˆæ˜¯å¦å­˜åœ¨
      async function testIconExists(size) {
        try {
          const response = await fetch(`/icons/icon-${size}x${size}.png`);
          const exists = response.ok;
          addTestResult(
            `åœ–ç¤º ${size}x${size}`,
            exists,
            exists ? "æª”æ¡ˆå­˜åœ¨" : "æª”æ¡ˆä¸å­˜åœ¨"
          );
          return exists;
        } catch (error) {
          addTestResult(`åœ–ç¤º ${size}x${size}`, false, "è¼‰å…¥å¤±æ•—");
          return false;
        }
      }

      // æ¸¬è©¦ favicon
      async function testFavicon() {
        try {
          const response = await fetch("/favicon.ico");
          const exists = response.ok;
          addTestResult("Favicon", exists, exists ? "æª”æ¡ˆå­˜åœ¨" : "æª”æ¡ˆä¸å­˜åœ¨");
          return exists;
        } catch (error) {
          addTestResult("Favicon", false, "è¼‰å…¥å¤±æ•—");
          return false;
        }
      }

      // æ¸¬è©¦ manifest
      async function testManifest() {
        try {
          const response = await fetch("/manifest.json");
          const exists = response.ok;
          addTestResult("Manifest", exists, exists ? "æª”æ¡ˆå­˜åœ¨" : "æª”æ¡ˆä¸å­˜åœ¨");
          return exists;
        } catch (error) {
          addTestResult("Manifest", false, "è¼‰å…¥å¤±æ•—");
          return false;
        }
      }

      // ç”Ÿæˆåœ–ç¤ºé è¦½
      function generateIconPreview() {
        sizes.forEach((size) => {
          const div = document.createElement("div");
          div.className = "icon-item";
          div.innerHTML = `
                    <img src="/icons/icon-${size}x${size}.png" alt="${size}x${size}">
                    <p>${size}x${size}</p>
                `;
          iconGrid.appendChild(div);
        });
      }

      // åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦
      async function runTests() {
        addTestResult("é–‹å§‹æ¸¬è©¦", true, "æ¸¬è©¦é–‹å§‹...");

        // æ¸¬è©¦ favicon
        await testFavicon();

        // æ¸¬è©¦ manifest
        await testManifest();

        // æ¸¬è©¦æ‰€æœ‰åœ–ç¤º
        for (const size of sizes) {
          await testIconExists(size);
        }

        // ç¸½çµ
        addTestResult(
          "æ¸¬è©¦ç¸½çµ",
          passedTests === totalTests,
          `${passedTests}/${totalTests} å€‹æ¸¬è©¦é€šé`
        );
      }

      // åˆå§‹åŒ–
      generateIconPreview();
      runTests();
    </script>
  </body>
</html>
