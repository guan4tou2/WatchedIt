(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[580],{6245:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(2898).Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},2245:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(2898).Z)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]])},2549:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(2898).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},6840:function(e,s,t){Promise.resolve().then(t.bind(t,3110))},3110:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return p}});var a=t(7437),l=t(2265),r=t(4033),n=t(5671),i=t(575),d=t(2782),c=t(2169);let o=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("textarea",{className:(0,c.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...l})});o.displayName="Textarea";var x=t(3277),m=t(3536),u=t(3181),h=t(3067),g=t(2245),j=t(6245);function p(){let e=(0,r.useRouter)(),{createWork:s,tags:t}=(0,m.B)(),[p,b]=(0,l.useState)(!1),[v,f]=(0,l.useState)({title:"",type:"動畫",status:"進行中",year:"",rating:"",review:"",note:"",source:""}),[y,N]=(0,l.useState)([]),k=async t=>{t.preventDefault(),b(!0);try{let t={title:v.title,type:v.type,status:v.status,year:v.year?parseInt(v.year):void 0,rating:v.rating?parseInt(v.rating):void 0,review:v.review||void 0,note:v.note||void 0,source:v.source||void 0,tags:y,episodes:[]},a=await s(t);e.push((0,c.a)("/works/detail?id=".concat(a.id)))}catch(e){console.error("創建作品失敗:",e)}finally{b(!1)}},w=e=>{f({...v,rating:v.rating===e.toString()?"":e.toString()})};return(0,a.jsxs)("div",{className:"container mx-auto p-6",children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)(i.z,{variant:"outline",size:"sm",onClick:()=>e.back(),children:[(0,a.jsx)(h.Z,{className:"w-4 h-4 mr-2"}),"返回"]}),(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"新增作品"})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsx)("div",{className:"lg:col-span-2",children:(0,a.jsxs)(n.Zb,{children:[(0,a.jsx)(n.Ol,{children:(0,a.jsx)(n.ll,{children:"作品資訊"})}),(0,a.jsx)(n.aY,{children:(0,a.jsxs)("form",{onSubmit:k,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium form-label-secondary",children:"標題 *"}),(0,a.jsx)(d.I,{value:v.title,onChange:e=>f({...v,title:e.target.value}),placeholder:"作品標題",required:!0,className:"mt-1"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium form-label-secondary",children:"類型 *"}),(0,a.jsxs)("select",{value:v.type,onChange:e=>f({...v,type:e.target.value}),className:"w-full mt-1 p-2 border rounded-md dark:text-foreground/95 dark:bg-background/95",required:!0,children:[(0,a.jsx)("option",{value:"動畫",children:"動畫"}),(0,a.jsx)("option",{value:"電影",children:"電影"}),(0,a.jsx)("option",{value:"電視劇",children:"電視劇"}),(0,a.jsx)("option",{value:"小說",children:"小說"}),(0,a.jsx)("option",{value:"漫畫",children:"漫畫"}),(0,a.jsx)("option",{value:"遊戲",children:"遊戲"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium form-label-secondary",children:"狀態 *"}),(0,a.jsxs)("select",{value:v.status,onChange:e=>f({...v,status:e.target.value}),className:"w-full mt-1 p-2 border rounded-md dark:text-foreground/95 dark:bg-background/95",required:!0,children:[(0,a.jsx)("option",{value:"進行中",children:"進行中"}),(0,a.jsx)("option",{value:"已完結",children:"已完結"}),(0,a.jsx)("option",{value:"暫停",children:"暫停"}),(0,a.jsx)("option",{value:"放棄",children:"放棄"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium form-label-secondary",children:"年份"}),(0,a.jsx)(d.I,{type:"number",value:v.year,onChange:e=>f({...v,year:e.target.value}),placeholder:"2023",min:"1900",max:"2030",className:"mt-1"})]})]}),(0,a.jsx)(u.Z,{availableTags:t,selectedTags:y,onTagsChange:N}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"評分"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 mt-2",children:[[1,2,3,4,5].map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>w(e),className:"p-2 rounded-md transition-colors ".concat(parseInt(v.rating||"0")>=e?"text-yellow-500 dark:text-yellow-400 bg-yellow-50 dark:bg-yellow-900/20":"star-icon-unselected"),children:(0,a.jsx)(g.Z,{className:"w-5 h-5",fill:parseInt(v.rating||"0")>=e?"currentColor":"none"})},e)),v.rating&&(0,a.jsxs)("span",{className:"text-sm status-text ml-2",children:[v.rating,"/5"]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium form-label-secondary",children:"評論"}),(0,a.jsx)(o,{value:v.review,onChange:e=>f({...v,review:e.target.value}),placeholder:"分享您的觀後感...",rows:3,className:"mt-1"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium form-label-secondary",children:"備註"}),(0,a.jsx)(o,{value:v.note,onChange:e=>f({...v,note:e.target.value}),placeholder:"其他備註...",rows:2,className:"mt-1"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium form-label-secondary",children:"來源"}),(0,a.jsx)(d.I,{value:v.source,onChange:e=>f({...v,source:e.target.value}),placeholder:"AniList, 手動新增...",className:"mt-1"})]}),(0,a.jsxs)("div",{className:"flex space-x-2 pt-4",children:[(0,a.jsxs)(i.z,{type:"submit",disabled:p,className:"flex-1",children:[(0,a.jsx)(j.Z,{className:"w-4 h-4 mr-2"}),p?"創建中...":"創建作品"]}),(0,a.jsx)(i.z,{type:"button",variant:"outline",onClick:()=>e.back(),className:"flex-1",children:"取消"})]})]})})]})}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(n.Zb,{children:[(0,a.jsx)(n.Ol,{children:(0,a.jsx)(n.ll,{children:"預覽"})}),(0,a.jsxs)(n.aY,{className:"space-y-4",children:[v.title&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-lg",children:v.title}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 mt-2",children:[(0,a.jsx)(x.C,{className:(e=>{switch(e){case"動畫":return"bg-purple-100 dark:bg-purple-900/20 text-purple-800 dark:text-purple-200";case"電影":return"bg-red-100 dark:bg-red-900/20 text-red-800 dark:text-red-200";case"電視劇":return"bg-blue-100 dark:bg-blue-900/20 text-blue-800 dark:text-blue-200";case"小說":return"bg-green-100 dark:bg-green-900/20 text-green-800 dark:text-green-200";case"漫畫":return"bg-orange-100 dark:bg-orange-900/20 text-orange-800 dark:text-orange-200";case"遊戲":return"bg-pink-100 dark:bg-pink-900/20 text-pink-800 dark:text-pink-200";default:return"badge-unselected"}})(v.type),children:v.type}),(0,a.jsx)(x.C,{className:(e=>{switch(e){case"進行中":return"bg-blue-100 dark:bg-blue-900/20 text-blue-800 dark:text-blue-200";case"已完結":return"bg-green-100 dark:bg-green-900/20 text-green-800 dark:text-green-200";case"暫停":return"bg-yellow-100 dark:bg-yellow-900/20 text-yellow-800 dark:text-yellow-200";case"放棄":return"bg-red-100 dark:bg-red-900/20 text-red-800 dark:text-red-200";default:return"badge-unselected"}})(v.status),children:(e=>{switch(e){case"進行中":return"進行中";case"已完結":return"已完結";case"暫停":return"暫停";case"放棄":return"放棄";default:return e}})(v.status)})]})]}),v.year&&(0,a.jsxs)("div",{className:"text-sm status-text",children:["年份: ",v.year]}),y.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium form-label-secondary mb-1",children:"標籤:"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:y.map(e=>(0,a.jsx)(x.C,{children:e.name},e.id))})]}),v.rating&&(0,a.jsxs)("div",{className:"flex items-center text-sm",children:[(0,a.jsx)(g.Z,{className:"w-4 h-4 mr-1 text-yellow-500"}),"評分: ",v.rating,"/5"]}),v.review&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium form-label-secondary mb-1",children:"評論:"}),(0,a.jsx)("div",{className:"text-sm text-gray-800 bg-gray-50 p-2 rounded",children:v.review})]}),v.note&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium form-label-secondary mb-1",children:"備註:"}),(0,a.jsx)("div",{className:"text-sm text-gray-800 bg-gray-50 p-2 rounded",children:v.note})]}),v.source&&(0,a.jsxs)("div",{className:"text-sm status-text",children:["來源: ",v.source]}),!v.title&&(0,a.jsx)("div",{className:"text-center empty-state py-8",children:"填寫資訊後將在此顯示預覽"})]})]}),(0,a.jsxs)(n.Zb,{children:[(0,a.jsx)(n.Ol,{children:(0,a.jsx)(n.ll,{className:"text-sm",children:"提示"})}),(0,a.jsxs)(n.aY,{className:"text-xs note-text space-y-2",children:[(0,a.jsx)("div",{children:"• 標題和類型為必填項目"}),(0,a.jsx)("div",{children:"• 可以為作品添加多個標籤"}),(0,a.jsx)("div",{children:"• 創建後可以立即添加集數"}),(0,a.jsx)("div",{children:"• 可以稍後在作品詳情頁面編輯"}),(0,a.jsx)("div",{children:"• 支援匯入/匯出資料"})]})]})]})]})]})}},3181:function(e,s,t){"use strict";t.d(s,{Z:function(){return c}});var a=t(7437),l=t(2265),r=t(3277),n=t(575),i=t(2549),d=t(9883);function c(e){let{availableTags:s,selectedTags:t,onTagsChange:c,disabled:o=!1}=e,[x,m]=(0,l.useState)(!1),u=e=>{t.some(s=>s.id===e.id)?c(t.filter(s=>s.id!==e.id)):c([...t,e])},h=e=>{c(t.filter(s=>s.id!==e))},g=s.filter(e=>!t.some(s=>s.id===e.id));return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"form-label",children:"標籤"}),t.length>0&&(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:t.map(e=>(0,a.jsxs)(r.C,{className:"flex items-center space-x-1",children:[(0,a.jsx)("span",{children:e.name}),!o&&(0,a.jsx)("button",{onClick:()=>h(e.id),className:"ml-1 hover:bg-black hover:bg-opacity-10 rounded-full p-0.5",children:(0,a.jsx)(i.Z,{className:"w-3 h-3"})})]},e.id))}),!o&&(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)(n.z,{type:"button",variant:"outline",size:"sm",onClick:()=>m(!x),className:"w-full justify-start",children:[(0,a.jsx)(d.Z,{className:"w-4 h-4 mr-2"}),0===t.length?"選擇標籤":"管理標籤"]}),x&&(0,a.jsx)("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white dropdown-bg border rounded-md shadow-lg z-10 max-h-48 overflow-y-auto",children:0===g.length?(0,a.jsx)("div",{className:"p-3 text-sm empty-state text-center",children:"所有標籤都已選擇"}):(0,a.jsx)("div",{className:"p-2 space-y-1",children:g.map(e=>(0,a.jsxs)("button",{onClick:()=>u(e),className:"w-full text-left p-2 hover:bg-gray-50 hover-bg rounded flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-4 h-4 rounded border"}),(0,a.jsx)("span",{className:"text-sm",children:e.name})]},e.id))})})]}),x&&(0,a.jsx)("div",{className:"fixed inset-0 z-0",onClick:()=>m(!1)})]})}}},function(e){e.O(0,[621,330,262,971,458,744],function(){return e(e.s=6840)}),_N_E=e.O()}]);