(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[157],{5311:function(e,t,r){Promise.resolve().then(r.bind(r,9978))},9978:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return n},dynamic:function(){return i}});var s=r(7437),l=r(2265),a=r(841);let i="force-dynamic";function n(){let[e,t]=(0,l.useState)([]),[r,i]=(0,l.useState)([]),[n,o]=(0,l.useState)(null),[c,d]=(0,l.useState)(""),[u,h]=(0,l.useState)(!1),p=()=>{try{let e=a.we.getAll(),r=a.IL.getAll(),s=a.we.getStats();t(e),i(r),o(s)}catch(e){console.error("載入數據失敗:",e)}};return((0,l.useEffect)(()=>{h(!0),p()},[]),u)?(0,s.jsxs)("div",{className:"container mx-auto p-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"本地儲存測試"}),(0,s.jsxs)("div",{className:"flex gap-2 mb-4",children:[(0,s.jsx)("button",{onClick:()=>{try{a.we.create({title:"測試作品 "+new Date().toLocaleTimeString(),type:"動畫",status:"進行中",year:2024,rating:4,source:"手動新增"}),p(),d("已新增測試作品")}catch(e){console.error("新增測試作品失敗:",e)}},className:"bg-blue-500 text-white px-4 py-2 rounded",children:"新增測試作品"}),(0,s.jsx)("button",{onClick:()=>{try{a.IL.create({name:"測試標籤 "+new Date().toLocaleTimeString(),color:"#FF6B6B"}),p(),d("已新增測試標籤")}catch(e){console.error("新增測試標籤失敗:",e)}},className:"bg-green-500 text-white px-4 py-2 rounded",children:"新增測試標籤"}),(0,s.jsx)("button",{onClick:()=>{try{(0,a.W0)(),p(),d("已初始化示例數據")}catch(e){console.error("初始化數據失敗:",e)}},className:"bg-purple-500 text-white px-4 py-2 rounded",children:"初始化示例數據"}),(0,s.jsx)("button",{onClick:()=>{try{localStorage.clear(),p(),d("已清除所有數據")}catch(e){console.error("清除數據失敗:",e)}},className:"bg-red-500 text-white px-4 py-2 rounded",children:"清除所有數據"})]}),c&&(0,s.jsx)("div",{className:"bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded mb-4",children:c}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"統計數據"}),n&&(0,s.jsx)("div",{className:"bg-gray-100 p-4 rounded",children:(0,s.jsx)("pre",{className:"text-sm",children:JSON.stringify(n,null,2)})})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold mb-4",children:["作品列表 (",e.length,")"]}),(0,s.jsx)("div",{className:"space-y-2",children:e.map(e=>(0,s.jsxs)("div",{className:"bg-white border p-3 rounded",children:[(0,s.jsx)("div",{className:"font-medium",children:e.title}),(0,s.jsxs)("div",{className:"text-sm text-gray-600",children:[e.type," • ",e.status," • ",e.year]}),e.rating&&(0,s.jsxs)("div",{className:"text-sm text-gray-600",children:["評分: ",e.rating,"/5"]})]},e.id))})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold mb-4",children:["標籤列表 (",r.length,")"]}),(0,s.jsx)("div",{className:"space-y-2",children:r.map(e=>(0,s.jsx)("div",{className:"bg-white border p-3 rounded",children:(0,s.jsx)("span",{className:"px-2 py-1 text-sm rounded",children:e.name})},e.id))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"原始數據"}),(0,s.jsxs)("div",{className:"bg-gray-100 p-4 rounded",children:[(0,s.jsx)("h3",{className:"font-medium mb-2",children:"localStorage 內容:"}),(0,s.jsx)("pre",{className:"text-xs overflow-auto",children:JSON.stringify({works:localStorage.getItem("watchedit_works"),tags:localStorage.getItem("watchedit_tags")},null,2)})]})]})]})]}):(0,s.jsxs)("div",{className:"container mx-auto p-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"本地儲存測試"}),(0,s.jsx)("p",{children:"載入中..."})]})}},841:function(e,t,r){"use strict";r.d(t,{IL:function(){return i},W0:function(){return n},we:function(){return a}});let s={WORKS:"watchedit_works",TAGS:"watchedit_tags"};function l(){return new Date().toISOString()}let a={getAll(){try{let e=localStorage.getItem(s.WORKS);return e?JSON.parse(e):[]}catch(e){return console.error("讀取作品數據失敗:",e),[]}},setAll(e){try{localStorage.setItem(s.WORKS,JSON.stringify(e))}catch(e){console.error("儲存作品數據失敗:",e)}},findByTitle(e){return this.getAll().find(t=>t.title===e)||null},findByAniListId(e){return this.getAll().find(t=>t.note&&t.note.includes("AniList ID: ".concat(e)))||null},create(e){var t;let r=this.getAll(),a={id:"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}),...e,reminder_enabled:null!==(t=e.reminder_enabled)&&void 0!==t&&t,date_added:l(),date_updated:void 0,tags:[],episodes:e.episodes||[]};return r.push(a),localStorage.setItem(s.WORKS,JSON.stringify(r)),a},update(e,t){let r=this.getAll(),a=r.findIndex(t=>t.id===e);return -1===a?null:(r[a]={...r[a],...t,date_updated:l()},localStorage.setItem(s.WORKS,JSON.stringify(r)),r[a])},delete(e){let t=this.getAll(),r=t.filter(t=>t.id!==e);return r.length!==t.length&&(localStorage.setItem(s.WORKS,JSON.stringify(r)),!0)},getList(e){let t=this.getAll();(null==e?void 0:e.title)&&(t=t.filter(t=>t.title.toLowerCase().includes(e.title.toLowerCase()))),(null==e?void 0:e.type)&&(t=t.filter(t=>t.type===e.type)),(null==e?void 0:e.status)&&(t=t.filter(t=>t.status===e.status)),(null==e?void 0:e.year)&&(t=t.filter(t=>t.year===e.year)),(null==e?void 0:e.tag_ids)&&e.tag_ids.length>0&&(t=t.filter(t=>t.tags.some(t=>e.tag_ids.includes(t.id))));let r=(null==e?void 0:e.page)||1,s=(null==e?void 0:e.size)||20,l=(r-1)*s;return{works:t.slice(l,l+s),total:t.length,page:r,size:s}},getStats(){let e=this.getAll(),t={};e.forEach(e=>{t[e.type]=(t[e.type]||0)+1});let r={};e.forEach(e=>{r[e.status]=(r[e.status]||0)+1});let s={};e.forEach(e=>{var t;let r=(null===(t=e.year)||void 0===t?void 0:t.toString())||"未知";s[r]=(s[r]||0)+1});let l=0,a=0;e.forEach(e=>{e.episodes&&(l+=e.episodes.length,a+=e.episodes.filter(e=>e.watched).length)});let i=l>0?Math.round(a/l*100):0;return{total_works:e.length,type_stats:t,status_stats:r,year_stats:s,episode_stats:{total_episodes:l,watched_episodes:a,completion_rate:i}}}},i={getAll(){try{let e=localStorage.getItem(s.TAGS);return e?JSON.parse(e):[]}catch(e){return console.error("讀取標籤數據失敗:",e),[]}},setAll(e){try{localStorage.setItem(s.TAGS,JSON.stringify(e))}catch(e){console.error("儲存標籤數據失敗:",e)}},create(e){let t=this.getAll(),r={id:Math.max(0,...t.map(e=>e.id))+1,...e};return t.push(r),localStorage.setItem(s.TAGS,JSON.stringify(t)),r},update(e,t){let r=this.getAll(),l=r.findIndex(t=>t.id===e);return -1===l?null:(r[l]={...r[l],...t},localStorage.setItem(s.TAGS,JSON.stringify(r)),r[l])},delete(e){let t=this.getAll(),r=t.filter(t=>t.id!==e);return r.length!==t.length&&(localStorage.setItem(s.TAGS,JSON.stringify(r)),!0)}},n=()=>{let e=a.getAll(),t=i.getAll();0===e.length&&(a.create({title:"進擊的巨人",type:"動畫",status:"已完結",year:2013,rating:5,review:"經典神作！",source:"AniList",episodes:[{id:"ep-1",number:1,title:"致2000年後的你",description:"艾連\xb7葉卡在夢中看到未來",type:"episode",season:1,watched:!0,date_watched:"2023-01-15T00:00:00.000Z"},{id:"ep-2",number:2,title:"那一天",description:"巨人入侵希干希納區",type:"episode",season:1,watched:!0,date_watched:"2023-01-15T00:00:00.000Z"},{id:"ep-special",number:1,title:"無悔的選擇",description:"里維兵長的外傳",type:"special",season:1,watched:!1}]}),a.create({title:"鬼滅之刃",type:"動畫",status:"進行中",year:2019,rating:4,source:"AniList",episodes:[{id:"ep-1",number:1,title:"殘酷",description:"竈門炭治郎的家人被鬼襲擊",type:"episode",season:1,watched:!0,date_watched:"2023-02-01T00:00:00.000Z"},{id:"ep-2",number:2,title:"培育者 鱗瀧左近次",description:"炭治郎開始學習呼吸法",type:"episode",season:1,watched:!0,date_watched:"2023-02-01T00:00:00.000Z"},{id:"ep-3",number:3,title:"鬼舞辻無慘",description:"炭治郎遇到鬼舞辻無慘",type:"episode",season:1,watched:!1}]}),a.create({title:"哈利波特與魔法石",type:"小說",status:"已完結",year:1997,rating:5,review:"魔法世界的開始",source:"手動新增",episodes:[{id:"ch-1",number:1,title:"活下來的男孩",description:"哈利波特被送到德思禮家",type:"chapter",season:1,watched:!0,date_watched:"2023-03-01T00:00:00.000Z"},{id:"ch-2",number:2,title:"消失的玻璃",description:"哈利發現自己的魔法能力",type:"chapter",season:1,watched:!0,date_watched:"2023-03-01T00:00:00.000Z"}]})),0===t.length&&(i.create({name:"神作",color:"#FF6B6B"}),i.create({name:"熱血",color:"#4ECDC4"}),i.create({name:"劇情",color:"#45B7D1"}),i.create({name:"魔法",color:"#96CEB4"}),i.create({name:"冒險",color:"#FFEAA7"}))}},622:function(e,t,r){"use strict";var s=r(2265),l=Symbol.for("react.element"),a=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,n=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,r){var s,a={},c=null,d=null;for(s in void 0!==r&&(c=""+r),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)i.call(t,s)&&!o.hasOwnProperty(s)&&(a[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps)void 0===a[s]&&(a[s]=t[s]);return{$$typeof:l,type:e,key:c,ref:d,props:a,_owner:n.current}}t.Fragment=a,t.jsx=c,t.jsxs=c},7437:function(e,t,r){"use strict";e.exports=r(622)}},function(e){e.O(0,[971,458,744],function(){return e(e.s=5311)}),_N_E=e.O()}]);